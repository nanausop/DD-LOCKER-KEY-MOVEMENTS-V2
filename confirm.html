<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirm - DD Locker</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>DD Locker: Key Movements Record</h1>
        <p class="disclaimer">I confirm that I have unlocked the DD locker and I am responsible for immediately returning the key to the main key box upon completion of my task.</p>
        <button id="returnKeyBtn">RETURN KEY</button>
    </div>

    <script>
        document.getElementById('returnKeyBtn').addEventListener('click', async function() {
            const urlParams = new URLSearchParams(window.location.search);
            const icNo = urlParams.get('ic');
            const timestamp = new Date().toLocaleString('en-MY', { timeZone: 'Asia/Kuala_Lumpur' });
            const data = { icNo, task: 'Returning the Key', returnTime: timestamp };

            await fetch('https://script.google.com/macros/s/AKfycbyTs7KJOaEfLp54ioMo9rO-cZvbhZ-7hL6bYEy7GOuRm4H-tGa1gQ9Ba09CpsY_NGFn/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });

            window.location.href = 'thankyou.html';
        });
    </script>
</body>
</html>
